<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convex Lens Simulation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body { display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
    </style>
</head>
<body>
    <script>
        let f = 100; // Focal length
        let u = -200; // Object distance
        let objectHeight = 50;

        function setup() {
            createCanvas(600, 400);
            createSlider(-300, -2*f, u, 1).position(10, 10).input(updateU);
            createSlider(50, 150, f, 1).position(10, 40).input(updateF);
        }

        function draw() {
            background(240);
            translate(width/2, height/2);
            
            // Calculate image distance
            let v = 1 / (1/f - 1/u);
            let imageHeight = -objectHeight * v / u;

            // Draw optical axis
            line(-width/2, 0, width/2, 0);

            // Draw lens
            stroke(0, 0, 255);
            line(0, -100, 0, 100);
            noFill();
            arc(-10, 0, 40, 200, -HALF_PI, HALF_PI);
            arc(10, 0, 40, 200, HALF_PI, -HALF_PI);

            // Draw focal points
            fill(255, 0, 0);
            ellipse(-f, 0, 5, 5);
            ellipse(f, 0, 5, 5);

            // Draw object
            stroke(0, 255, 0);
            line(u, 0, u, -objectHeight);
            fill(0, 255, 0);
            ellipse(u, -objectHeight, 5, 5);

            // Draw image
            if (v > 0) {
                stroke(255, 0, 255);
                line(v, 0, v, -imageHeight);
                fill(255, 0, 255);
                ellipse(v, -imageHeight, 5, 5);
            }

            // Draw rays
            stroke(255, 165, 0);
            // Ray 1: Through center
            line(u, -objectHeight, v, -imageHeight);
            // Ray 2: Parallel to axis, then through focal point
            line(u, -objectHeight, 0, -objectHeight);
            line(0, -objectHeight, v, -imageHeight);
            // Ray 3: Through focal point, then parallel to axis
            line(u, -objectHeight, 0, -objectHeight * f / (f - u));
            line(0, -objectHeight * f / (f - u), v, -imageHeight);

            // Display values
            fill(0);
            textAlign(LEFT);
            text(`Object distance (u): ${u}`, -width/2 + 10, height/2 - 40);
            text(`Focal length (f): ${f}`, -width/2 + 10, height/2 - 20);
            text(`Image distance (v): ${v.toFixed(2)}`, -width/2 + 10, height/2 - 60);
        }

        function updateU() {
            u = this.value();
        }

        function updateF() {
            f = this.value();
        }
    </script>
</body>
</html>
